rules:
  # è§„åˆ™1: è´¦æˆ·è¢«é”å®šç”¨æˆ·çš„å¤§é¢äº¤æ˜“é¢„è­¦
  - name: "é”å®šè´¦æˆ·å¤§é¢äº¤æ˜“é¢„è­¦"
    description: "å½“è¢«é”å®šç”¨æˆ·å°è¯•è¿›è¡Œå¤§é¢äº¤æ˜“æ—¶è§¦å‘é¢„è­¦"
    salience: 10
    when:
      - type: "fact"
        fact_type: "User"
        field: "Status"
        operator: "=="
        value: "locked"
      - type: "fact"
        fact_type: "Transaction"
        field: "Amount"
        operator: ">"
        value: 10000
        join:
          left_field: "ID"
          right_field: "UserID"
    then:
      type: "log"
      message: "ğŸš¨ é«˜é£é™©: é”å®šè´¦æˆ·ç”¨æˆ·å°è¯•å¤§é¢äº¤æ˜“"

  # è§„åˆ™2: æ£€æµ‹ä¸å­˜åœ¨æœ‰æ•ˆè´¦æˆ·çš„äº¤æ˜“ï¼ˆä½¿ç”¨ NOTï¼‰
  - name: "æ— æ•ˆè´¦æˆ·äº¤æ˜“æ£€æµ‹"
    description: "æ£€æµ‹æ²¡æœ‰å¯¹åº”æœ‰æ•ˆè´¦æˆ·çš„äº¤æ˜“"
    salience: 8
    when:
      - type: "fact"
        fact_type: "Transaction"
        field: "Status"
        operator: "=="
        value: "pending"
      - type: "not"
        fact_type: "Account"
        field: "Status"
        operator: "=="
        value: "active"
        join:
          left_field: "UserID"
          right_field: "UserID"
    then:
      type: "log"
      message: "âš ï¸  æ£€æµ‹åˆ°æ— æ•ˆè´¦æˆ·äº¤æ˜“"

  # è§„åˆ™3: æ£€æµ‹å­˜åœ¨å¤±è´¥ç™»å½•çš„ç”¨æˆ·äº¤æ˜“ï¼ˆä½¿ç”¨ EXISTSï¼‰
  - name: "å¤±è´¥ç™»å½•ç”¨æˆ·äº¤æ˜“ç›‘æ§"
    description: "ç›‘æ§æœ‰å¤±è´¥ç™»å½•è®°å½•çš„ç”¨æˆ·çš„äº¤æ˜“è¡Œä¸º"
    salience: 6
    when:
      - type: "fact"
        fact_type: "Transaction"
        field: "Amount"
        operator: ">"
        value: 5000
      - type: "exists"
        fact_type: "LoginAttempt"
        field: "Success"
        operator: "=="
        value: false
        join:
          left_field: "UserID"
          right_field: "UserID"
    then:
      type: "log"
      message: "ğŸ” å…³æ³¨: æœ‰å¤±è´¥ç™»å½•è®°å½•çš„ç”¨æˆ·è¿›è¡Œå¤§é¢äº¤æ˜“"

  # è§„åˆ™4: å¤šæ¬¡å¤±è´¥ç™»å½•èšåˆæ£€æµ‹ï¼ˆä½¿ç”¨ AGGREGATEï¼‰
  - name: "å¤šæ¬¡å¤±è´¥ç™»å½•æ£€æµ‹"
    description: "æ£€æµ‹åŒä¸€ç”¨æˆ·å¤šæ¬¡å¤±è´¥ç™»å½•"
    salience: 9
    when:
      - type: "aggregate"
        fact_type: "LoginAttempt"
        field: "Success"
        operator: "=="
        value: false
        group_by: "UserID"
        aggregate: "count"
        threshold: 3
    then:
      type: "log"
      message: "ğŸš¨ ä¸¥é‡: æ£€æµ‹åˆ°å¤šæ¬¡å¤±è´¥ç™»å½•ï¼Œå¯èƒ½çš„æš´åŠ›ç ´è§£"