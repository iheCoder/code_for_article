rules:
  # æœ€é«˜ä¼˜å…ˆçº§ï¼šç´§æ€¥å®‰å…¨æ£€æµ‹ï¼ˆSalience: 100ï¼‰
  - name: "ç´§æ€¥_å¤§é¢å¼‚åœ°äº¤æ˜“æ£€æµ‹"
    description: "æ£€æµ‹å¤§é¢å¼‚åœ°äº¤æ˜“ï¼Œç«‹å³å†»ç»“"
    salience: 100
    when:
      - type: "fact"
        fact_type: "Transaction"
        field: "Amount"
        operator: ">"
        value: 50000
      - type: "fact"
        fact_type: "UserProfile"
        field: "HomeLocation"
        operator: "!="
        value: "Beijing"
        join:
          left_field: "UserID"
          right_field: "UserID"
    then:
      type: "log"
      message: "ğŸš¨ ç´§æ€¥è­¦æŠ¥ï¼šæ£€æµ‹åˆ°å¤§é¢å¼‚åœ°äº¤æ˜“ï¼ç«‹å³å†»ç»“è´¦æˆ·"

  # é«˜ä¼˜å…ˆçº§ï¼šèšåˆé£é™©æ£€æµ‹ï¼ˆSalience: 80ï¼‰
  - name: "èšåˆ_å¤šæ¬¡å¤±è´¥ç™»å½•æ£€æµ‹"
    description: "æ£€æµ‹ç”¨æˆ·å¤šæ¬¡å¤±è´¥ç™»å½•å°è¯•"
    salience: 80
    when:
      - type: "aggregate"
        fact_type: "LoginAttempt"
        group_by: "UserID"
        aggregate: "count"
        threshold: 3
        field: "Success"
        operator: "=="
        value: false
    then:
      type: "log"
      message: "âš ï¸ é£é™©è­¦æŠ¥ï¼šæ£€æµ‹åˆ°å¤šæ¬¡å¤±è´¥ç™»å½•ï¼Œå»ºè®®ä¸´æ—¶é”å®šç”¨æˆ·"

  # ä¸­ç­‰ä¼˜å…ˆçº§ï¼šNOTé€»è¾‘æ£€æµ‹ï¼ˆSalience: 50ï¼‰
  - name: "NOT_æœªç»‘å®šå¯ä¿¡è®¾å¤‡çš„é«˜é£é™©äº¤æ˜“"
    description: "æ£€æµ‹åœ¨éå¯ä¿¡è®¾å¤‡ä¸Šçš„é«˜é£é™©äº¤æ˜“"
    salience: 50
    when:
      - type: "fact"
        fact_type: "Transaction"
        field: "Amount"
        operator: ">"
        value: 10000
      - type: "not"
        fact_type: "DeviceInfo"
        field: "Trusted"
        operator: "=="
        value: true
        join:
          left_field: "UserID"
          right_field: "UserID"
    then:
      type: "log"
      message: "ğŸ” å®‰å…¨æç¤ºï¼šé«˜é¢äº¤æ˜“æœªåœ¨å¯ä¿¡è®¾å¤‡ä¸Šæ“ä½œï¼Œéœ€è¦é¢å¤–éªŒè¯"

  # ä¸­ç­‰ä¼˜å…ˆçº§ï¼šå¤æ‚æ¡ä»¶æ£€æµ‹ï¼ˆSalience: 40ï¼ŒSpecificity: 4ï¼‰
  - name: "å¤æ‚_æ–°ç”¨æˆ·é«˜é£é™©è¡Œä¸ºæ£€æµ‹"
    description: "æ–°ç”¨æˆ·çš„å¤æ‚é£é™©è¡Œä¸ºæ¨¡å¼æ£€æµ‹"
    salience: 40
    when:
      - type: "fact"
        fact_type: "UserProfile"
        field: "RegistrationAge"
        operator: "<"
        value: 30
      - type: "fact"
        fact_type: "UserProfile"
        field: "RiskScore"
        operator: ">"
        value: 70
        join:
          left_field: "UserID"
          right_field: "UserID"
      - type: "fact"
        fact_type: "Transaction"
        field: "Amount"
        operator: ">"
        value: 5000
        join:
          left_field: "UserID"
          right_field: "UserID"
      - type: "fact"
        fact_type: "Transaction"
        field: "Type"
        operator: "=="
        value: "withdraw"
        join:
          left_field: "UserID"
          right_field: "UserID"
    then:
      type: "log"
      message: "ğŸ¯ ç²¾å‡†è¯†åˆ«ï¼šæ–°ç”¨æˆ·é«˜é£é™©æç°è¡Œä¸ºï¼Œéœ€è¦äººå·¥å®¡æ ¸"

  # ä½ä¼˜å…ˆçº§ï¼šåŸºç¡€æ£€æµ‹ï¼ˆSalience: 20ï¼ŒSpecificity: 2ï¼‰
  - name: "åŸºç¡€_å¤§é¢äº¤æ˜“æ£€æµ‹"
    description: "åŸºç¡€å¤§é¢äº¤æ˜“æ£€æµ‹"
    salience: 20
    when:
      - type: "fact"
        fact_type: "Transaction"
        field: "Amount"
        operator: ">"
        value: 20000
      - type: "fact"
        fact_type: "User"
        field: "Status"
        operator: "=="
        value: "normal"
        join:
          left_field: "UserID"
          right_field: "ID"
    then:
      type: "log"
      message: "ğŸ’° å¸¸è§„æé†’ï¼šæ£€æµ‹åˆ°å¤§é¢äº¤æ˜“ï¼Œå»ºè®®å…³æ³¨"

  # ä½ä¼˜å…ˆçº§ï¼šEXISTSé€»è¾‘æ£€æµ‹ï¼ˆSalience: 10ï¼‰
  - name: "EXISTS_æ´»è·ƒç”¨æˆ·ä¼˜æƒ æ£€æµ‹"
    description: "ä¸ºæœ‰äº¤æ˜“è®°å½•çš„æ´»è·ƒç”¨æˆ·æä¾›ä¼˜æƒ "
    salience: 10
    when:
      - type: "fact"
        fact_type: "User"
        field: "Level"
        operator: "=="
        value: "VIP"
      - type: "exists"
        fact_type: "Transaction"
        field: "Status"
        operator: "=="
        value: "completed"
        join:
          left_field: "ID"
          right_field: "UserID"
    then:
      type: "log"
      message: "ğŸ ä¼˜æƒ æé†’ï¼šæ´»è·ƒVIPç”¨æˆ·å¯äº«å—ä¸“å±ä¼˜æƒ "

  # æœ€ä½ä¼˜å…ˆçº§ï¼šé€šç”¨æ£€æµ‹ï¼ˆSalience: 5ï¼ŒSpecificity: 1ï¼‰
  - name: "é€šç”¨_ç”¨æˆ·çŠ¶æ€ç›‘æ§"
    description: "é€šç”¨ç”¨æˆ·çŠ¶æ€ç›‘æ§"
    salience: 5
    when:
      - type: "fact"
        fact_type: "User"
        field: "Status"
        operator: "=="
        value: "suspicious"
    then:
      type: "log"
      message: "ğŸ‘€ çŠ¶æ€ç›‘æ§ï¼šæ£€æµ‹åˆ°å¯ç–‘ç”¨æˆ·çŠ¶æ€"
